# Project Waypoint Product Requirements Document (PRD)

**Date:** May 26, 2025
**Version:** 1.0 (Focus on "Waypoint Archive" - Epic 1 detailed, Epic 2 & 3 outlined)

## Goal, Objective and Context

**Overall Project Goal:**
To preserve the "almost 25 years" of invaluable knowledge from The Magic Cafe forum by first creating a complete, locally-hosted raw HTML archive and a structured data version ("Waypoint Archive"). Subsequently, this archive will serve as the foundation for "Project Waypoint," an AI-powered research tool, making this content accessible and deeply searchable for the magic community.

**Immediate Objectives (for the "Waypoint Archive" phase):**
1.  **Comprehensive Data Indexing:** To develop and execute a process that reliably identifies and catalogs all unique topics (threads) across all sub-forums of The Magic Cafe. (Considered achieved by user).
2.  **Complete Data Preservation:** To download and securely store the full raw HTML content of every page for every identified topic on the user's local Synology NAS, ensuring no data is left behind.
3.  **Initial Data Structuring:** To process the raw HTML archive locally into a structured, machine-readable format (e.g., JSON per thread), accurately parsing key metadata and content elements like quoted text and attributions.

**Context:**
The Magic Cafe forum, a significant resource for the magic community for nearly 25 years, is at high risk of permanent data loss. This risk stems from its outdated technology, the owner's reported personal and financial circumstances, and its recent de-indexing by Google, which limits its visibility and utility. Project Waypoint is initiated with urgency to mitigate this risk. The initial "Waypoint Archive" phase will operate under a "no external budget" constraint, leveraging the user's existing hardware (laptop for indexing, Synology NAS for storage and processing) and development time. Subsequent phases to develop the AI tool will incur API costs, which the user is prepared to cover. The archival process must be conducted "politely" to minimize impact on the live forum server.

## Functional Requirements (MVP - "Waypoint Archive")

These requirements outline the necessary functionalities of the scripts and processes involved in creating the "Waypoint Archive."

**1. Indexing System (Topic ID & URL Collection):**
    1.1. The system MUST be able to navigate through all pages of a given Magic Cafe sub-forum listing (e.g., `viewforum.php` pages). This includes dynamically re-checking total sub-forum page counts if the list of pages grows during its scan.
    1.2. The system MUST accurately identify and extract all unique topic (thread) IDs and their direct URLs (if readily available and distinct, with ID being primary) from the HTML of these sub-forum pages.
    1.3. The system MUST implement a two-pass strategy for each sub-forum:
        1.3.1. An initial pass to scan all pages of the sub-forum and collect unique topic IDs.
        1.3.2. A subsequent, immediate re-scan of the first few (configurable, e.g., 1-3) pages of that sub-forum to identify and collect any topic IDs that were newly created or re-encountered (confirming their presence if bumped) during the initial pass.
    1.4. The system MUST store the collected unique topic IDs in a persistent, de-duplicated list (e.g., a text file or simple database) that can be consumed by the Archival System.
    1.5. The system MUST be configurable to run on the user's laptop.
    1.6. The system MUST provide clear logging of its progress (e.g., current sub-forum being processed, number of pages scanned, number of unique topic IDs found) and any errors encountered.
    1.7. The system MUST be able to handle common HTML structures found on forum listing pages and identify relevant links.
    1.8. The system MUST track its indexing rate (e.g., topics or pages of topics indexed per unit of time).
    1.9. The system MUST provide an estimated time to completion (ETC) for the current sub-forum indexing task, dynamically updated based on its ongoing measured performance and the total known items (e.g., pages) for that sub-forum.
    1.10. The system (or an associated utility) MUST be able to provide an initial ETC for indexing any new, unstarted sub-forum, based on the known number of topics/pages in that sub-forum and historical performance data from previous indexing runs.

**2. Archival System (Raw HTML Download & Storage):**
    2.1. The system MUST read the master list of unique topic IDs (and associated metadata, ordered by sub-forum size) generated by the Indexing System.
    2.2. For each topic ID, the system MUST navigate all of its internal pages (e.g., page 1, 2, 3 of a thread).
    2.3. The system MUST download the complete, unaltered raw HTML content for every page of every specified topic.
    2.4. The system MUST save these raw HTML files to a user-specified location on the Synology NAS.
    2.5. The saved HTML files MUST be organized in a logical directory structure (e.g., `ARCHIVE_ROOT/{sub_forum_name_or_id}/{topic_id}/page_{page_number}.html`).
    2.6. The system MUST implement "polite scraping" features:
        2.6.1. Configurable delay (e.g., 2-5 seconds, adjustable, testable, and tunable) between HTTP requests.
        2.6.2. Ability to be scheduled or run during user-defined off-peak hours (by being cleanly startable/stoppable by an external scheduler).
        2.6.3. Send a custom User-Agent string with each request.
    2.7. The system MUST implement state management to allow for resumable operation.
    2.8. The system MUST provide detailed logging of its progress and any errors.
    2.9. The system MUST track its archival rate.
    2.10. The system MUST provide an ETC for the current archival batch, dynamically updated.
    2.11. The system (or an associated utility) MUST be able to provide an initial ETC for archiving any new, unstarted batch of threads.

**3. Structured Data Extraction System (Local Processing):**
    3.1. The system MUST read the raw HTML files from the local "Waypoint Archive" stored on the Synology NAS.
    3.2. For each archived HTML page, the system MUST parse it to extract individual posts.
    3.3. For each post, the system MUST extract defined metadata (Post ID, page number, post URL, username, timestamp).
    3.4. The system MUST parse post content into structured `content_blocks`, differentiating `new_text` and `quote` blocks.
    3.5. For `quote` blocks, the system MUST extract quoted user, quoted timestamp, and quoted text.
    3.6. The system MUST save the extracted structured data (e.g., one JSON file per thread) locally.
    3.7. The system MUST be robust to HTML variations.
    3.8. The system MUST provide logging of its progress and errors.
    *(Acknowledged: The specific details within section 3 are preliminary and will be finalized after Phase 1 and 2 provide the complete raw HTML dataset for detailed analysis.)*

## Non Functional Requirements (MVP - "Waypoint Archive")

These non-functional requirements (NFRs) apply to the scripts and processes used to create and manage the "Waypoint Archive."

**1. Performance:**
    1.1. **Scraping Efficiency:** While adhering to "polite scraping" delays, scripts should maximize data throughput within defined operational windows.
    1.2. **Processing Efficiency:** Local data extraction should be efficient on the user's Synology NAS.
    1.3. **Resource Utilization:** Scripts should be mindful of system resources.

**2. Reliability & Robustness:**
    2.1. **Data Completeness & Integrity:** Aim for 100% capture of identified topic pages.
    2.2. **Error Handling:** Scripts must handle common errors gracefully, log them, and attempt to retry or skip problematic items without halting the entire process where feasible.
    2.3. **Resumability:** Archival script must be resumable.
    2.4. **Predictable Behavior:** Scripts should behave consistently.

**3. Usability (of the Archival Scripts & Process):**
    3.1. **Configuration:** Key parameters should be easily configurable.
    3.2. **Logging Clarity:** Logs must be clear, human-readable, and provide sufficient detail.
    3.3. **Operational Simplicity:** Initiating, monitoring, stopping, and resuming scripts should be straightforward.

**4. Maintainability (of the Archival Scripts):**
    4.1. **Code Clarity:** Code should be well-organized, commented, and follow good programming practices.

**5. Scalability (of the Archival Process & Data Store):**
    5.1. **Full Forum Volume:** Process must handle the full anticipated volume of The Magic Cafe.
    5.2. **Storage Management:** Directory structure and file naming should manage a large number of files efficiently.

## User Interaction and Design Goals

The "Waypoint Archive" phase of this project is primarily focused on data acquisition and backend processing. The scripts and tools developed for this phase will be command-line operated or have minimal operational interfaces designed for the user (the project initiator) to manage the archival process. Standard usability for such tools (clear logging, configurable parameters, straightforward execution) is covered under Non-Functional Requirements.

Detailed User Interaction and Design Goals for the subsequent AI-powered front-end research tool (the ultimate vision of Project Waypoint) will be defined in a later stage of product development, after the "Waypoint Archive" is successfully established. The vision for this tool includes a natural language query interface and conversational interaction, with a focus on intuitive access to the archived data and clear citation of sources.

## Technical Assumptions

This section outlines the foundational technical assumptions for Project Waypoint, with an initial focus on the "Waypoint Archive" phase.

**For the "Waypoint Archive" Phase (MVP):**

* **Primary Development Language:** The initial proof-of-concept for thread scraping was developed in Python. The project will start with **Go (Golang)** for the archival scripts, with Python as a fallback if Go development proves unexpectedly challenging. This decision is formalized in the "Waypoint Archive Tech Stack Selection" document.
* **Execution Environment:**
    * Indexing scripts: User's laptop.
    * HTML archival scripts: Synology NAS (potentially as a Docker app for scheduled/unattended operation) and/or user's laptop. Scripts to be designed for platform-agnostic operation.
    * Structured data extraction scripts: Synology NAS.
* **Data Storage:**
    * Raw HTML Archive: Individual HTML files on the user's Synology NAS.
    * Structured Data: JSON files (one per thread) on the user's Synology NAS.
    * Topic Index / Progress Files: Flat files (text, JSON) on the user's laptop (for indexing) and Synology NAS (for archival process state).
* **Scraping Methodology:** Will adhere to "polite scraping" principles.
* **Target Forum Stability:** The Magic Cafe forum's HTML is assumed to be relatively stable. Scripts must include robust error handling.
* **Network Connectivity:** Assumed reliable for laptop and NAS.

**Repository & Service Architecture:**

* **For "Waypoint Archive" Scripts:**
    * **Repository Structure:** Likely a single Git repository.
    * **Service Architecture:** N/A (local scripts).
* **For the Future AI Research Tool (Project Waypoint - Phase 3 & 4 of overall plan):**
    * **Repository Structure:** TBD.
    * **Service Architecture:** TBD.

### Testing requirements

**For "Waypoint Archive" Scripts (MVP):**

* **Unit Testing:** Focus on HTML parsing logic, URL generation, state management.
* **Integration Testing (Conceptual):** Workflow between scripts, tested via controlled runs on small sub-forums.
* **Verification:** Data completeness, polite scraping mechanisms, resumability, structured data output, logging, and ETC accuracy.

**For the Future AI Research Tool (Project Waypoint - Phase 3 & 4 of overall plan):**
* To be defined when that phase is planned.

## Epic Overview

*(Note: The detailed User Stories for each Epic will reside in separate, dedicated Epic documents, e.g., `docs/epics/epic-1.md`, `docs/epics/epic-2.md`, etc. This overview provides the high-level goals.)*

**Epic 1: Forum Indexing System Development & Initial Full Index Creation**
* **Goal:** To develop, test, and execute a robust indexing system capable of navigating all sub-forums and their pages on The Magic Cafe, generating a comprehensive and de-duplicated master list of all unique topic IDs, preparing the groundwork for complete content archival.
* **Status:** The primary objective (generation of the complete Topic ID list) is considered **achieved** by the user through initial development and testing. The detailed User Stories (1.1-1.9) below serve as a record and specification of the developed/validated system.

    *(The full User Stories 1.1 through 1.9 with their descriptions and Acceptance Criteria, as previously detailed and approved, would be listed here in a full PRD version intended for archival or if not sharding. For this handoff, we acknowledge they are defined and will be placed in `docs/epics/epic-1.md` or are considered complete for development purposes.)*

**Epic 2: Raw HTML Archival System Development & Full Archive Execution**
* **Goal:** To develop, test, and execute a polite, resumable archival system that downloads and stores the complete raw HTML content of every page for every topic identified in Epic 1, creating a permanent local backup of The Magic Cafe forum on the user's Synology NAS.
*(Detailed User Stories 2.1 through 2.10 for this Epic will be defined in a separate document: `docs/epics/epic-2.md`)*

**Epic 3: Structured Data Extraction System Development & Initial Processing**
* **Goal:** To develop, test, and execute a system that processes the archived raw HTML, accurately extracting post metadata and content (including structured quote information) into a locally stored, machine-readable format (e.g., JSON files per thread), making the data ready for future AI processing.
*(Detailed User Stories for this Epic will be defined in a separate document: `docs/epics/epic-3.md`)*

## Key Reference Documents

* Project Brief: `docs/Project_Brief_Project_Waypoint.md` (Assuming this is where Mary's output would be saved)
* Waypoint Archive Tech Stack Selection: `docs/Waypoint_Archive_Tech_Stack.md`
* Operational Guidelines: `docs/operational-guidelines.md`
* Detailed Epic Specifications:
    * `docs/epics/epic-1.md` (Contains detailed stories for Epic 1)
    * `docs/epics/epic-2.md` (To be created for detailed stories for Epic 2)
    * `docs/epics/epic-3.md` (To be created for detailed stories for Epic 3)

## Out of Scope Ideas Post MVP

*(This refers to ideas out of scope for the overall Project Waypoint AI tool, beyond the "Waypoint Archive" and initial AI tool features. To be populated later.)*

* The "Waypoint Archive" foundational phase explicitly defers text embedding, vector database creation, and LLM front-end development to subsequent project phases (which are part of the overall Project Waypoint scope but not the *initial* archive MVP).

## [OPTIONAL: For Simplified PM-to-Development Workflow Only] Core Technical Decisions & Application Structure

*(This section is not applicable as Project Waypoint will involve architectural design for the AI tool phase.)*

## Change Log

| Change | Date | Version | Description | Author |
| :----- | :--- | :------ | :---------- | :----- |
| Initial PRD Draft for Epic 1 Focus | May 26, 2025 | 1.0 | Created initial PRD, detailed Epic 1 stories, outlined Epics 2 & 3 goals. | John (PM) |

----- END PRD START CHECKLIST OUTPUT ------

*(PM Checklist to be run by John against this PRD draft at a suitable point, likely after Epic 2 & 3 stories are also detailed or before a major handoff).*

----- END Checklist START Design Architect `UI/UX Specification Mode` Prompt ------

*(Not applicable for "Waypoint Archive" phase)*

----- END Design Architect `UI/UX Specification Mode` Prompt START Architect Prompt ------

## Initial Architect Prompt

*(This prompt is primarily for the later AI research tool phase of Project Waypoint.)*

Based on our discussions and requirements analysis for **Project Waypoint**, particularly for the AI research tool to be built upon the **"Waypoint Archive,"** the following initial technical guidance will inform your architecture analysis and decisions when that phase begins:

### Technical Infrastructure (for the future AI Tool)
* **Data Source:** The "Waypoint Archive" (locally stored raw HTML and structured JSON data from Epic 3).
* **Core Functionality:** Semantic search, natural language querying, conversational interaction with archived forum content.
* **Key Technologies to Incorporate (User is willing to pay API costs):**
    * Text Embedding Models (e.g., OpenAI)
    * Vector Database (specific choice TBD)
    * Large Language Models (e.g., OpenAI GPT series) for response synthesis and interaction.
* **Deployment Environment for AI Tool:** TBD.

### Technical Constraints (for the future AI Tool)
* Must interface with the structured JSON output of the "Waypoint Archive."
* Must provide accurate citations linking back to the raw HTML archive.

### Local Development & Testing Requirements (for the future AI Tool)
* To be defined.

### Other Technical Considerations (for the future AI Tool)
* Scalability of the vector search solution.
* Cost management for embedding and LLM API calls.
* Potential for a simple web front-end.

This information should serve as a starting point for the architectural design of the AI-powered research tool component of Project Waypoint once the "Waypoint Archive" foundational data is secured.

----- END Architect Prompt -----